#!/bin/bash

MODEL_NAME=${1:-default}

bash bin/training $MODEL_NAME

echo
echo "=========================================================================================="
echo "Running Exparser, please wait..."
echo "=========================================================================================="
echo

docker run -v $(pwd):/app excite_toolchain exparser $MODEL_NAME

echo
echo "=========================================================================================="
echo "Evaluating extraction, please wait..."
echo "=========================================================================================="
echo

docker run -it --rm -v $(pwd):/app excite_toolchain eval ./Exparser/Dataset/${MODEL_NAME}/SEG/ ./Data/3-refs/ extr

echo
echo "=========================================================================================="
echo "Evaluating segmentation, please wait..."
echo "=========================================================================================="
echo

docker run -it --rm -v $(pwd):/app excite_toolchain eval ./Exparser/Dataset/${MODEL_NAME}/SEG/ ./Data/3-refs_seg/ seg
